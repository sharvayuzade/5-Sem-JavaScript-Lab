<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ES6+ Billing Calculator & User Registration</title>
</head>
<body>
    <h1>ES6+ JavaScript Applications</h1>
    
    <!-- Task 1: Billing Calculator -->
    <h2>Task 1: Billing Calculator</h2>
    <form id="billingForm">
        <label for="itemName">Item Name:</label>
        <input type="text" id="itemName" name="itemName" required><br><br>
        
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" name="quantity" min="1"><br><br>
        
        <label for="price">Price per Item (₹):</label>
        <input type="number" id="price" name="price" min="0" step="0.01" required><br><br>
        
        <button type="submit">Calculate Bill</button>
    </form>
    
    <div id="billingResult"></div>
    <hr><br>

    <!-- Task 2: User Registration Form -->
    <h2>Task 2: User Registration</h2>
    <form id="registrationForm">
        <label for="userName">Full Name:</label>
        <input type="text" id="userName" name="name" required><br><br>
        
        <label for="userAge">Age:</label>
        <input type="number" id="userAge" name="age" min="13" max="120" required><br><br>
        
        <label for="userEmail">Email Address:</label>
        <input type="email" id="userEmail" name="email" required><br><br>
        
        <button type="submit">Register User</button>
    </form>
    
    <div id="registrationResult"></div>

    <script>
        const calculateBill = ({ itemName, quantity = 1, price }) => {
            const numQuantity = parseInt(quantity) || 1;
            const numPrice = parseFloat(price) || 0;
            
            if (!itemName.trim()) {
                throw new Error('Item name cannot be empty');
            }
            
            if (numPrice <= 0) {
                throw new Error('Price must be greater than 0');
            }
            
            const total = numQuantity * numPrice;
            
            return `You ordered ${numQuantity} ${itemName}(s) at ₹${numPrice.toFixed(2)} each. Total: ₹${total.toFixed(2)}`;
        };

        document.getElementById('billingForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const billingData = Object.fromEntries(formData.entries());
            
            const resultDiv = document.getElementById('billingResult');
            
            try {
                const result = calculateBill(billingData);
                resultDiv.innerHTML = `<p style="color: green;">${result}</p>`;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        });

        const isValidEmail = (email) => {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        };

        const validateUser = (userData) => {
            const { name, age, email } = userData;
            
            const errors = [];
            
            if (!name || !name.trim()) {
                errors.push('Name cannot be empty');
            }
            
            const numAge = parseInt(age);
            if (!age || numAge < 13 || numAge > 120) {
                errors.push('Age must be between 13 and 120');
            }
            
            if (!email || !isValidEmail(email)) {
                errors.push('Please enter a valid email address');
            }
            
            return {
                isValid: errors.length === 0,
                errors,
                userData: { name: name?.trim(), age: numAge, email: email?.toLowerCase() }
            };
        };

        const generateWelcomeMessage = ({ name, age, email }) => {
            return `Welcome, ${name} (Age: ${age}). Your email ${email} has been registered successfully!`;
        };

        document.getElementById('registrationForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const userData = Object.fromEntries(formData.entries());
            
            const resultDiv = document.getElementById('registrationResult');
            
            const validation = validateUser(userData);
            
            if (validation.isValid) {
                const welcomeMessage = generateWelcomeMessage(validation.userData);
                resultDiv.innerHTML = `<p style="color: green;">${welcomeMessage}</p>`;
                
                setTimeout(() => {
                    e.target.reset();
                }, 3000);
            } else {
                const errorList = validation.errors.map(error => `• ${error}`).join('<br>');
                resultDiv.innerHTML = `<p style="color: red;">Registration failed:<br>${errorList}</p>`;
            }
        });
    </script>
</body>
</html>